<head><h3>Problem MK &mdash; эмулятор</h3></head>
<style>
table, th, td {
  border: 1px solid black;
}
.mytab {
  position:absolute; left:200px;
}
</style>
<body>
<p>Регистровый файл состоит из четырёх восьмиразрядных регистров</p>
<table>
  <caption>Register file</caption>
  <tr>
    <th>Register</th>
    <th>A</th>
    <th>B</th>
    <th>C</th>
    <th>D</th>
  </tr>
  <tr>
    <th>Encoding (binary)</th>    
    <th>00</th>
    <th>01</th>
    <th>10</th>
    <th>11</th>
  </tr>
</table>

<p>Вам задана следующая система команд и таблица мнемоник</p>
<table>
  <caption>Instruction set</caption>
  <tr>
    <th>Mnemonic</th>
    <th>Encoding (binary)</th>
  </tr>
  <tr>
    <th>MOVI Imm &mdash; move constant to D register</th>
    <th>0IIIIIII</th>
  </tr>
  <tr>
    <th>ADD R, R &mdash; add two registers modulo 256</th>
    <th>1000RRRR</th>
  </tr>
  <tr>
    <th>SUB R, R &mdash; sub two registers modulo 256</th>
    <th>1001RRRR</th>
  </tr>
  <tr>
    <th>MUL R, R &mdash; mul two registers modulo 256</th>
    <th>1010RRRR</th>
  </tr>
  <tr>
    <th>DIV R, R &mdash; div two registers modulo 256</th>
    <th>1011RRRR</th>
  </tr>
  <tr>
    <th>IN R &mdash; read register R from keyboard</th>
    <th>110000RR</th>
  </tr>
  <tr>
    <th>OUT R &mdash; write register R to screen</th>
    <th>110001RR</th>
  </tr>
</table>
<p>Вам приходит закодированная программа как параметр argv[1] и стандартный ввод на stdin</p>
<p>Вам необходимо симулировать работу программы и вывести всё что она выводит на stdout</p>
<br/>
<p>Пример 1</p>
<p>Программа: 0x70 0xc7 0xc1 0x87 0x27 0xc5 0x8d 0xc1 0x87 0x6f 0xc5 0xc7</p>
<p>Вход:104 64</p>
<p>Выход:112 216 63 111</p>
<p>Пояснение: программа состоит (если записать её символически) из следующих команд</p>
<p>MOVI 112 <span class="mytab">D = 112</span></p>
<p>OUT D <span class="mytab">output 112</span></p>
<p>IN B <span class="mytab">read 104</span></p>
<p>ADD B, D <span class="mytab">B = 104 + 112</span></p>
<p>MOVI 39 <span class="mytab">D = 39</span></p>
<p>OUT B <span class="mytab">output 216</span></p>
<p>ADD D, B <span class="mytab">D = 216 + 39</span></p>
<p>IN B <span class="mytab">read 64</span></p>
<p>ADD B, D <span class="mytab">B = (216 + 39 + 64) mod 256</span></p>
<p>MOVI 111 <span class="mytab">D = 111</span></p>
<p>OUT B <span class="mytab">output 63</span></p>
<p>OUT D <span class="mytab">output 111</span></p>
<br/>
</body>

